{% extends 'base.html'%}
{% block maincontent %}

<div class="body-index">
    {% comment %} <form action="{% url 'kunwariwebpage:chatbot'%}" method="post" enctype="multipart/form-data"> {% endcomment %}
    <form>
        {% csrf_token %}
        <h1>Kunwari Activator</h1>
        <textarea id="prompt" placeholder="eg. mathematics, 60 minutes, learning objectives" name="prompt"></textarea>
        <button class="submit" type="submit" id="submit-to-chatgpt">Send</button>
        <button class="submit" type="submit" id="generate-episodes" hidden>Generate Episodes</button>
        <button class="submit" type="submit" id="generate-content" hidden>Generate Content</button>
        <button class="submit" type="submit" id="generate-facilitator-script" hidden>Generate Facilitator Script</button>
        <button class="submit" type="submit" id="generate-pptx" disabled>Generate Powerpoint</button>
    </form>
    
    <div class="chat-container">
        <ul class="tabs-heading">
            <li data-target="lesson_plan" class="active">Lesson plan</li>
            <li data-target="episodes">Episodes</li>
            <li data-target="content">Content</li>
            <li data-target="facilitator_script">Script</li>
        </ul>
        <div class="tabs-body">
            <div id="lesson_plan" class="chat_response" contenteditable></div>
            <div id="episodes" class="chat_response" contenteditable hidden></div>
            <div id="content" class="chat_response" contenteditable hidden></div>
            <div id="facilitator_script" class="chat_response" contenteditable hidden></div>
        </div>
        <div class="message-download">
            <button class="submit btn-under-gptresponse" id="download-pptx" disabled>Download</button>
            <button class="submit btn-under-gptresponse" onClick="window.location.href=window.location.href" >Reset</button>
            <p id="message"></p>
        </div>
    </div>
    
    
    <div class="user-options">
        <button class="btn user-btn" onclick="toggleDropdown()">
            <i class='bx bxs-user'></i>
        </button>
        <div id="userDropdown" class="dropdown">
            <a href="#" onclick="toggleThemeDropdown()">
                <i class='bx bxs-palette'></i>Change Theme
            </a>
            <div id="themeDropdown" class="dropdown theme-dropdown">
                <a href="#" onclick="setTheme('light')"><i class='bx bxs-sun'></i>Light Mode</a>
                <a href="#" onclick="setTheme('dark')"><i class='bx bxs-moon'></i>Dark Mode</a>
                <a href="#" onclick="setTheme('system')"><i class='bx bx-desktop'></i>System Default</a>
            </div>
            <a href="{% url 'pricings:pricing_list'%}"><i class='bx bxs-purchase-tag'></i>Pricing</a>
            <a href="#"><i class='bx bxs-cog'></i>Settings</a>
            {% comment %} {% if params.isAdmin %}
            <a href="{% url 'users:accounts'%}"><i class='bx bxs-cog'></i>Accounts</a>
            {% endif %} {% endcomment %}
            <a href="{% url 'users:logout_user'%}"><i class='bx bxs-log-out'></i>Logout</a>
        </div>
    </div>

    <div class="logo">
        <a href="{% url 'kunwariwebpage:index'%}">
            <button class="btn btn-logo">
                <img src="/static/BINGExp.png">
            </button>
        </a>
    </div>
</div>
<div>
    <h1>Kunwari Activator</h1>
    <p>
        is an innovative EdTech platform that transforms all content into immersive, 
        experiential learning.  By bridging the gap between theory and application, 
        Kunwari Activator facilitates comprehension and engagement with complex subjects.  
        Applicable to education, training, and storytelling, our platform enhances knowledge 
        retention by translating concepts into interactive, real-world simulations.
    </p>

    <h1>How to Use the Application</h1>
    <ol>
        <li>
            <strong>I. Generate a Lesson Plan</strong>
            <ul>
                <li>1. Type a topic into the input field.</li>
                <li>2. Click the <strong>Send(click again to regenerate)</strong> button.</li>
                <li>3. A lesson plan will appear in the right-side container, where you can freely edit the text to your liking.</li>
            </ul>
        </li>

        <li>
            <strong>II. Save Your Lesson Plan</strong>
            <ul>
                <li>1. Click the <strong>Generate PowerPoint</strong> button.</li>
                <li>2. Click the <strong>Download</strong> button to save your lesson plan as a <code>.pptx</code> file.</li>
            </ul>
        </li>

        <li>
            <strong>III. Enhance Your Lesson Plan</strong>
            <ul>
                <li>
                    <strong>- Generate Episodes:</strong><br> 
                    1. Break down the lesson plan into structured episodes.<br>
                    2. <em>To save, click <strong>Generate PowerPoint</strong> and then <strong>Download</strong>.</em>
                </li>
                <li>
                    <strong>- Generate Content(click again to regenerate):</strong><br>
                    1. Add detailed content to each slide generated in the Episodes phase.<br>
                    2. <em>To save, click <strong>Generate PowerPoint</strong> and then <strong>Download</strong>.</em>
                </li>
                <li>
                    <strong>- Generate Facilitator Script:(click again to regenerate)</strong><br> 
                    1. Create a detailed script for the slides generated in the Content phase.<br>
                    2. <em>To save, click <strong>Generate PowerPoint</strong> and then <strong>Download</strong>.</em>
                </li>
            </ul>
        </li>
    </ol>
    <p>Note: The contents of the powerpoint generated are always based on the right-side container(Text field)</p>

    <h1>How It Works</h1>

    <ol>
        <li>
        <strong>I. Initial Prompting</strong>
        <ul>
            <li>1. When you enter a topic, the system uses a series of additional prompts to generate a structured lesson plan based on that topic.</li>
        </ul>
        </li>

        <li>
        <strong>II. Chained Generation</strong>
        <ul>
            <li>1. The generated lesson plan becomes the basis (prompt) for the next stage, such as when generating <strong>Episodes</strong>.</li>
            <li>2. This ensures all outputs stay aligned with your original topic.</li>
            <li>3. The same process applies when generating <strong>Content</strong> and <strong>Facilitator Scripts</strong>.</li>
        </ul>
        </li>

        <li>
        <strong>III. Important Note on Sequence</strong>
        <ul>
            <li>1. If the generation steps are not followed in order (e.g., generating the Facilitator Script immediately after generating Episodes without first generating Content), the output may be incomplete or misaligned.</li>
            <li>2. <strong>Recommended Sequence:</strong> Lesson Plan → Episodes → Content → Facilitator Script</li>
            <li>3. Following this sequence ensures the best quality output.</li>
        </ul>
        </li>
    </ol>
</div>

<script> // TEXTAREA HEIGHT AUTO RESIZE
    const textarea = document.getElementById('prompt');

    textarea.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    });
</script>

<script> // USER DROPDOWN
    function toggleDropdown() {
        document.getElementById("userDropdown").classList.toggle("show");
      }
    
      window.onclick = function(event) {
        if (!event.target.matches('.user-btn') && !event.target.closest('.user-options')) {
          var dropdown = document.getElementById("userDropdown");
          if (dropdown.classList.contains('show')) {
            dropdown.classList.remove('show');
          }
        }
      }
</script>

<script> // THEME DROPDOWN
    function toggleThemeDropdown() {
        const dropdown = document.getElementById('themeDropdown');
        dropdown.classList.toggle('show');
    }
    
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('themeDropdown');
        const toggleButton = document.querySelector("a[onclick='toggleThemeDropdown()']");
        
        if (!toggleButton.contains(event.target) && !dropdown.contains(event.target)) {
            dropdown.classList.remove('show');
        }
    });
</script>

{% endblock %}
